{"version":3,"file":"static/js/874.6b74deef.chunk.js","mappings":"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","sources":["../node_modules/react-leaflet/lib/Circle.js","../node_modules/@react-leaflet/core/lib/circle.js","components/ally/NodeMiniMap.jsx"],"sourcesContent":["import { createElementObject, createPathComponent, extendContext, updateCircle } from '@react-leaflet/core';\nimport { Circle as LeafletCircle } from 'leaflet';\nexport const Circle = createPathComponent(function createCircle({ center, children: _c, ...options }, ctx) {\n    const circle = new LeafletCircle(center, options);\n    return createElementObject(circle, extendContext(ctx, {\n        overlayContainer: circle\n    }));\n}, updateCircle);\n","export function updateCircle(layer, props, prevProps) {\n    if (props.center !== prevProps.center) {\n        layer.setLatLng(props.center);\n    }\n    if (props.radius != null && props.radius !== prevProps.radius) {\n        layer.setRadius(props.radius);\n    }\n}\n","import React, { useEffect, useState } from 'react';\nimport { MapContainer, TileLayer, Marker, Circle as LeafletCircle } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// Status color mapping for the pin\nconst statusColors = {\n  good: '#22c55e',      // green-500\n  okay: '#f59e0b',      // amber-500\n  need_help: '#ef4444', // red-500\n  offline: '#6b7280',   // gray-500\n};\n\nconst getStatusColor = (status, userStatus) => {\n  if (status === 'offline') return statusColors.offline;\n  if (userStatus === 'need_help') return statusColors.need_help;\n  if (userStatus === 'okay') return statusColors.okay;\n  return statusColors.good;\n};\n\n// Create a custom marker icon\nconst createMarkerIcon = (color, isNeedHelp = false) => {\n  const svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 36\" width=\"28\" height=\"42\">\n      <path d=\"M12 0C5.4 0 0 5.4 0 12c0 7.2 12 24 12 24s12-16.8 12-24c0-6.6-5.4-12-12-12z\" fill=\"${color}\" stroke=\"#fff\" stroke-width=\"2\"/>\n      <circle cx=\"12\" cy=\"12\" r=\"4\" fill=\"#fff\"/>\n      ${isNeedHelp ? '<circle cx=\"12\" cy=\"12\" r=\"6\" fill=\"none\" stroke=\"#fff\" stroke-width=\"1.5\" opacity=\"0.6\"><animate attributeName=\"r\" values=\"6;9;6\" dur=\"1s\" repeatCount=\"indefinite\"/><animate attributeName=\"opacity\" values=\"0.6;0;0.6\" dur=\"1s\" repeatCount=\"indefinite\"/></circle>' : ''}\n    </svg>\n  `;\n  \n  return L.divIcon({\n    className: 'custom-mini-map-marker',\n    html: svg,\n    iconSize: [28, 42],\n    iconAnchor: [14, 42],\n    popupAnchor: [0, -42],\n  });\n};\n\nexport default function NodeMiniMap({ lat, lon, nodeName, nodeStatus, userStatus, accuracy, fixStatus }) {\n  const [isReady, setIsReady] = useState(false);\n  \n  useEffect(() => {\n    // Small delay to ensure CSS is loaded\n    const timer = setTimeout(() => setIsReady(true), 50);\n    return () => clearTimeout(timer);\n  }, []);\n  \n  if (!isReady) {\n    return (\n      <div className=\"h-40 glass flex items-center justify-center\">\n        <p className=\"text-xs text-muted-foreground\">Loading map...</p>\n      </div>\n    );\n  }\n  \n  const color = getStatusColor(nodeStatus, userStatus);\n  const isNeedHelp = userStatus === 'need_help';\n  const markerIcon = createMarkerIcon(color, isNeedHelp);\n  \n  // Convert accuracy from meters to feet for display\n  const accuracyFeet = accuracy ? Math.round(accuracy * 3.28084) : null;\n  \n  return (\n    <div className=\"relative\">\n      <MapContainer\n        center={[lat, lon]}\n        zoom={15}\n        className=\"h-40 w-full z-0\"\n        style={{ background: 'hsl(var(--muted))' }}\n        scrollWheelZoom={false}\n        dragging={true}\n        zoomControl={false}\n        attributionControl={false}\n        data-testid=\"node-mini-map-container\"\n      >\n        <TileLayer\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        \n        {/* Accuracy circle */}\n        {accuracy && (\n          <LeafletCircle\n            center={[lat, lon]}\n            radius={accuracy}\n            pathOptions={{\n              color: color,\n              fillColor: color,\n              fillOpacity: 0.15,\n              weight: 1,\n            }}\n          />\n        )}\n        \n        {/* Node marker */}\n        <Marker position={[lat, lon]} icon={markerIcon} />\n      </MapContainer>\n      \n      {/* Node name overlay */}\n      <div className=\"absolute top-2 left-2 z-[1000] bg-background/90 backdrop-blur-sm px-2 py-1 rounded-lg shadow-md border border-border\">\n        <div className=\"flex items-center gap-1.5\">\n          <div className=\"w-2.5 h-2.5 rounded-full\" style={{ backgroundColor: color }} />\n          <span className=\"text-xs font-semibold\">{nodeName}</span>\n        </div>\n      </div>\n      \n      {/* Accuracy overlay */}\n      {accuracyFeet && (\n        <div className=\"absolute bottom-2 right-2 z-[1000] bg-background/90 backdrop-blur-sm px-2 py-1 rounded-lg shadow-md border border-border\">\n          <span className=\"text-xs text-muted-foreground\">Â±{accuracyFeet} ft accuracy</span>\n        </div>\n      )}\n      \n      {/* Fix status badge */}\n      <div className={`absolute top-2 right-2 z-[1000] px-2 py-1 rounded-lg shadow-md border ${\n        fixStatus === '3D' ? 'bg-success/20 border-success/30 text-success' : \n        fixStatus ? 'bg-warning/20 border-warning/30 text-warning' :\n        'bg-destructive/20 border-destructive/30 text-destructive'\n      }`}>\n        <span className=\"text-xs font-bold\">{fixStatus || 'No'} Fix</span>\n      </div>\n    </div>\n  );\n}\n"],"names":["Circle","createPathComponent","_ref","ctx","center","children","_c","options","_objectWithoutProperties","_excluded","circle","LeafletCircle","createElementObject","extendContext","overlayContainer","layer","props","prevProps","setLatLng","radius","setRadius","statusColors","NodeMiniMap","lat","lon","nodeName","nodeStatus","userStatus","accuracy","fixStatus","isReady","setIsReady","useState","useEffect","timer","setTimeout","clearTimeout","_jsx","className","color","getStatusColor","status","markerIcon","isNeedHelp","arguments","length","undefined","svg","concat","L","html","iconSize","iconAnchor","popupAnchor","createMarkerIcon","accuracyFeet","Math","round","_jsxs","MapContainer","zoom","style","background","scrollWheelZoom","dragging","zoomControl","attributionControl","TileLayer","url","pathOptions","fillColor","fillOpacity","weight","Marker","position","icon","backgroundColor"],"ignoreList":[],"sourceRoot":""}